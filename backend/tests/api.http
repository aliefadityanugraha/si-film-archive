### SI Film Archive API Testing
### Gunakan REST Client extension di VS Code
### 
### CARA PAKAI:
### 1. Jalankan "Login User" dulu
### 2. Copy value dari set-cookie header (better-auth.session_token=xxx)
### 3. Paste di variable @sessionCookie di bawah

@baseUrl = http://localhost:3000/api
@contentType = application/json
@origin = http://localhost:5173

### PASTE SESSION COOKIE DISINI SETELAH LOGIN ###
@sessionCookie = better-auth.session_token=OaZv6OqmSRpdavZF96It48vEaQ1KCQL4.cO9vIog6ULEFgBY9zzaYIOaG1TgZJL4heY5TSxJuMfc%3D;

### ============================================
### HEALTH CHECK
### ============================================

### Health Check
GET {{baseUrl}}/health

### ============================================
### AUTH - Register & Login
### ============================================

### Register User Baru
POST {{baseUrl}}/auth/sign-up/email
Content-Type: {{contentType}}
Origin: {{origin}}

{
  "email": "testuser@example.com",
  "password": "password123",
  "name": "Test User"
}

### Register Admin
POST {{baseUrl}}/auth/sign-up/email
Content-Type: {{contentType}}
Origin: {{origin}}

{
  "email": "admin@example.com",
  "password": "admin123",
  "name": "Admin User"
}

### Register Creator
POST {{baseUrl}}/auth/sign-up/email
Content-Type: {{contentType}}
Origin: {{origin}}

{
  "email": "creator@example.com",
  "password": "creator123",
  "name": "Creator User"
}

### Login User (JALANKAN INI DULU, LALU COPY COOKIE)
POST {{baseUrl}}/auth/sign-in/email
Content-Type: {{contentType}}
Origin: {{origin}}

{
  "email": "testuser@example.com",
  "password": "password123"
}

### Login Admin
POST {{baseUrl}}/auth/sign-in/email
Content-Type: {{contentType}}
Origin: {{origin}}

{
  "email": "admin@example.com",
  "password": "admin123"
}

### Login Creator
POST {{baseUrl}}/auth/sign-in/email
Content-Type: {{contentType}}
Origin: {{origin}}

{
  "email": "creator@example.com",
  "password": "creator123"
}

### Get Session (perlu cookie)
GET {{baseUrl}}/auth/session
Origin: {{origin}}
Cookie: {{sessionCookie}}

### Logout
POST {{baseUrl}}/auth/sign-out
Origin: {{origin}}
Cookie: {{sessionCookie}}

### ============================================
### USER PROFILE (perlu login)
### ============================================

### Get Profile
GET {{baseUrl}}/auth/profile
Origin: {{origin}}
Cookie: {{sessionCookie}}

### Get All Roles
GET {{baseUrl}}/auth/roles
Origin: {{origin}}
Cookie: {{sessionCookie}}

### Get All Users (Admin only)
GET {{baseUrl}}/auth/users
Origin: {{origin}}
Cookie: {{sessionCookie}}

### Update User Role (Admin only)
### Ganti USER_ID_HERE dengan ID user yang ingin diubah
PATCH {{baseUrl}}/auth/users/USER_ID_HERE/role
Content-Type: {{contentType}}
Origin: {{origin}}
Cookie: {{sessionCookie}}

{
  "role_id": 2
}

### ============================================
### CATEGORIES
### ============================================

### Get All Categories (public)
GET {{baseUrl}}/categories

### Get Categories with Film Count (public)
GET {{baseUrl}}/categories/with-count

### Get Single Category (public)
GET {{baseUrl}}/categories/1

### Create Category (Admin only)
POST {{baseUrl}}/categories
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "nama_kategori": "Film Pendek",
  "deskripsi": "Film dengan durasi di bawah 30 menit"
}

### Create Category 2 (Admin only)
POST {{baseUrl}}/categories
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "nama_kategori": "Dokumenter",
  "deskripsi": "Film dokumenter non-fiksi"
}

### Create Category 3 (Admin only)
POST {{baseUrl}}/categories
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "nama_kategori": "Animasi",
  "deskripsi": "Film animasi 2D/3D"
}

### Update Category (Admin only)
PUT {{baseUrl}}/categories/1
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "nama_kategori": "Film Pendek Updated",
  "deskripsi": "Deskripsi yang sudah diupdate"
}

### Delete Category (Admin only)
DELETE {{baseUrl}}/categories/3
Cookie: {{sessionCookie}}

### ============================================
### FILMS
### ============================================

### Get All Films (public - published only)
GET {{baseUrl}}/films

### Get Films with Pagination
GET {{baseUrl}}/films?page=1&limit=5

### Get Films by Category
GET {{baseUrl}}/films?category_id=1

### Search Films
GET {{baseUrl}}/films?search=pendek

### Get Latest Films
GET {{baseUrl}}/films/latest?limit=5

### Get Single Film (public)
GET {{baseUrl}}/films/1

### Get My Films (Creator only)
GET {{baseUrl}}/films/my-films
Cookie: {{sessionCookie}}

### Get Pending Films (Admin only)
GET {{baseUrl}}/films/pending
Cookie: {{sessionCookie}}

### Create Film (Creator/Admin only)
POST {{baseUrl}}/films
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "judul": "Film Pendek Pertama",
  "category_id": 1,
  "sinopsis": "Ini adalah sinopsis film pendek pertama saya.",
  "tahun_karya": 2024,
  "link_video_utama": "https://youtube.com/watch?v=abc123",
  "link_trailer": "https://youtube.com/watch?v=xyz789",
  "gambar_poster": "/uploads/poster1.jpg",
  "deskripsi_lengkap": "Poster ini menggambarkan perjalanan hidup",
  "crew": [
    { "jabatan": "Sutradara", "anggota": ["John Doe"] },
    { "jabatan": "Penulis Skenario", "anggota": ["Jane Doe"] }
  ]
}

### Create Film 2
POST {{baseUrl}}/films
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "judul": "Dokumenter Kampus",
  "category_id": 2,
  "sinopsis": "Dokumenter tentang kehidupan kampus",
  "tahun_karya": 2024,
  "link_video_utama": "https://youtube.com/watch?v=doc123"
}

### Update Film (Owner only)
PUT {{baseUrl}}/films/1
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "judul": "Film Pendek Pertama (Revisi)",
  "sinopsis": "Sinopsis yang sudah direvisi"
}

### Approve Film (Admin only)
PATCH {{baseUrl}}/films/1/approve
Cookie: {{sessionCookie}}

### Reject Film (Admin only)
PATCH {{baseUrl}}/films/2/reject
Cookie: {{sessionCookie}}

### Delete Film (Owner only)
DELETE {{baseUrl}}/films/2
Cookie: {{sessionCookie}}

### ============================================
### VOTES
### ============================================

### Get Trending Films (public)
GET {{baseUrl}}/votes/trending?period=week&limit=10

### Get Trending - Month
GET {{baseUrl}}/votes/trending?period=month

### Get Trending - All Time
GET {{baseUrl}}/votes/trending?period=all

### Get Vote Count for Film (public, tapi has_voted perlu login)
GET {{baseUrl}}/votes/film/1
Cookie: {{sessionCookie}}

### Vote Film (perlu login)
POST {{baseUrl}}/votes/film/1
Cookie: {{sessionCookie}}

### Toggle Vote (perlu login)
POST {{baseUrl}}/votes/film/1/toggle
Cookie: {{sessionCookie}}

### Unvote Film (perlu login)
DELETE {{baseUrl}}/votes/film/1
Cookie: {{sessionCookie}}

### Get My Votes (perlu login)
GET {{baseUrl}}/votes/my-votes
Cookie: {{sessionCookie}}

### ============================================
### DISCUSSIONS (Comments)
### ============================================

### Get Comments for Film (public)
GET {{baseUrl}}/discussions/film/1

### Get Comment Count (public)
GET {{baseUrl}}/discussions/film/1/count

### Post Comment (perlu login)
POST {{baseUrl}}/discussions/film/1
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "isi_pesan": "Film yang sangat bagus!"
}

### Reply to Comment (perlu login)
POST {{baseUrl}}/discussions/film/1
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "isi_pesan": "Setuju banget!",
  "parent_id": 1
}

### Update Comment (Owner only)
PUT {{baseUrl}}/discussions/1
Content-Type: {{contentType}}
Cookie: {{sessionCookie}}

{
  "isi_pesan": "Film yang sangat bagus! (edited)"
}

### Delete Comment (Owner/Moderator/Admin)
DELETE {{baseUrl}}/discussions/1
Cookie: {{sessionCookie}}

### Get All Comments - Flat (Moderator/Admin only)
GET {{baseUrl}}/discussions/all
Cookie: {{sessionCookie}}
